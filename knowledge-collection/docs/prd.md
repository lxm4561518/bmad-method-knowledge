# 内容提取与转录工具产品需求文档 (PRD)

## 1. 目标与背景 (Goals and Background Context)

### 目标 (Goals)
- **减少内容消费时间**：通过将视频/音频转换为文本，将1小时的视频内容获取时间缩短至10分钟以内。
- **统一内容入口**：提供单一的命令行工具，支持多种平台（知乎、公众号、头条、Bilibili、抖音等）的内容提取。
- **自动化转录**：针对视频内容，自动下载音频并调用 ASR 模型进行高精度转录。
- **Cookie 鉴权支持**：允许用户配置 Cookie 以获取需要登录或会员权限的高质量内容。
- **结构化输出**：所有提取内容统一输出为标准化的 JSON 格式，便于后续处理和归档。

### 背景 (Background Context)
在信息爆炸的时代，高效获取知识成为核心竞争力。然而，大量优质信息以视频形式存在于 Bilibili、抖音等平台，或者分散在知乎、公众号等文本平台。视频内容的线性观看特性极大地限制了信息获取速度，且难以检索和整理。现有的工具大多功能单一，无法同时处理文本和视频，且缺乏统一的输出格式。本项目旨在开发一个基于 Python 的全能内容提取器，通过“提取+转录”的混合模式，打破格式壁垒，极大提升用户的知识套利效率。

### 变更日志 (Change Log)
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-12-17 | 1.0 | Initial PRD Release | John (PM) |

## 2. 需求 (Requirements)

### 功能需求 (Functional Requirements)
- **FR1 (URL 解析与分发)**: 系统必须能够接收用户输入的 URL，并自动识别所属平台（如知乎、Bilibili、抖音等）及内容类型（文本或视频）。
- **FR2 (Cookie 管理)**: 系统需提供加载 `cookies.json` 的机制，根据域名自动匹配并注入对应的 Cookie，以支持获取受限内容（如高清视频流或会员文章）。
- **FR3 (纯文本提取)**:
    - 针对知乎、公众号、头条等文本类网站，系统应抓取文章标题和正文内容。
    - **支持平台详情**：
        - **知乎 (Zhihu)**: 提取问题标题、高赞回答内容或专栏文章正文。需处理“阅读更多”展开逻辑（如果存在）。
        - **微信公众号 (WeChat)**: 提取文章标题、作者、发布时间、正文内容（需去除干扰性的二维码、广告图片占位符）。
        - **今日头条 (Toutiao)**: 提取新闻/文章标题及正文。
    - **内容清洗**：必须移除 HTML 标签、脚本、样式表、广告链接、推荐阅读模块，仅保留纯净的段落文本。
    - **原文保真**：必须保留原文的段落结构和顺序，**严禁**进行任何形式的摘要、总结或改写。
- **FR4 (视频/音频提取)**:
    - 针对 Bilibili、抖音、腾讯视频等视频网站，系统应调用 `yt-dlp` 或相关非官方 API 下载音频轨道技术。
    - 支持处理短视频（抖音）和长视频（Bilibili）。
- **FR5 (自动语音转录)**:
    - 系统必须集成 OpenAI Whisper 或同等能力的 ASR 模型。
    - 自动将下载的音频文件转录为文本，支持中文识别。
- **FR6 (标准化输出)**:
    - 提取结果必须保存为 JSON 文件。
    - JSON 结构必须包含：`title` (标题), `content` (原文/转录文本), `url` (原始链接), `timestamp` (采集时间)。

### 非功能需求 (Non-Functional Requirements)
- **NFR1 (性能)**: 文本提取应在 5 秒内完成；10 分钟视频的转录应在 2 分钟内完成（依赖硬件，但需优化流程）。
- **NFR2 (准确性)**: 文本抓取完整度需 > 95%；语音转录准确率需 > 90%（在清晰音频下）。
- **NFR3 (易用性)**: 命令行界面 (CLI) 应简洁明了，仅需输入 URL 即可运行，报错信息需人性化。
- **NFR4 (可扩展性)**: 架构设计应支持通过插件或子类化轻松添加新的网站解析器 (Extractor)。

## 3. 用户界面设计目标 (User Interface Design Goals)

### 总体 UX 愿景
作为一个命令行工具 (CLI)，核心体验应是“无感”和“极速”。用户不需要复杂的交互，只需“输入链接 -> 得到文件”。

### 关键交互范式
1.  **启动**：`python main.py <URL>`
2.  **反馈**：
    - `[INFO] 检测到 Bilibili 链接，正在加载 Cookies...`
    - `[INFO] 正在下载音频... (30%)`
    - `[INFO] 正在转录... (Whisper model: base)`
    - `[SUCCESS] 提取完成！文件已保存至 outputs/bv12345.json`

### 输出示例 (JSON)
```json
{
  "title": "如何高效学习 Python？",
  "content": "大家主要关心的是... (此处为 5000 字转录全文)",
  "url": "https://www.bilibili.com/video/BVxxxx",
  "timestamp": "2025-12-17 10:00:00"
}
```

## 4. 技术假设 (Technical Assumptions)
- 用户本地已安装 Python 3.8+ 环境。
- 用户有能力获取并提供有效的 `cookies.json`（如果是会员内容）。
- 本地机器有足够的算力运行 Whisper 模型（或接受调用 API 的成本）。
- 目标网站的反爬策略在常规 Cookie 注入下可被绕过，不涉及复杂的验证码破解（暂不作为 MVP 范围）。
